name: TestExecute Installation test
run-name: TestExecute run from GitHub Action (${{ github.actor }})
on:
  push:
  
jobs:
  DownloadInstallAndRunTE:
    name: Install and Run TestExecute (${{ github.actor }})
    
    runs-on: windows-latest
    permissions: write-all
    steps:
      
      - name: Job Startup
        run: |
          echo "Starting job [Event=${{ github.event_name }}]"
          echo "This job is now running on a ${{ runner.os }} server hosted by GitHub!"
      - name: Download TestExecute
        run: |
          Invoke-WebRequest -Uri "${{ vars.TEST_EXECUTE_DOWNLOAD_URL }}" -o "./TestCompleteInstaller.exe"  
      - name: Show working folder content
        run: dir
        shell: cmd
      - name: Install TestExecute
        run: .\TestCompleteInstaller.exe > output.txt /SilentInstall /AccessKey:"${{ secrets.TEST_EXECUTE_ACCESS_KEY }}"
             echo "TestComplete is installed"
        shell : cmd
      - name : list the directory content
        run: |
          ls
          echo "Hence TestComplete Installed successfully"
      - name: Find TestComplete Installed files
        run : ls 'C:\Program Files (x86)\SmartBear\'
      - name: Env Variable for TestExecute bin folder
        run: set PATH_TE="${{ vars.TEST_EXECUTE_BIN }}"
        shell: cmd
      - name : Execute Test
        run : 'C:\Program Files (x86)\SmartBear\TestComplete 15\Bin\TestComplete.exe' /run "\AngularAutomation\AngularAutomation.pjs" /AccessKey:"f09c4a43-c7ce-4d28-ba11-6e99403d2c81" /test:"\AngularAutomation\AngularAutomation\KeywordTestsKeywordTests|DepositAmount" /ExportSummary :"report.xml"
        shell : cmd
         

        
