name: TestExecute Installation test
run-name: TestExecute run from GitHub Action (${{ github.actor }})
on:
  push:
  
jobs:
  DownloadInstallAndRunTE:
    name: Install and Run TestExecute (${{ github.actor }})
    
    runs-on: windows-latest
    permissions: write-all
    steps:
      
      - name: Job Startup
        run: |
          echo "Starting job [Event=${{ github.event_name }}]"
          echo "This job is now running on a ${{ runner.os }} server hosted by GitHub!"
      - name: Download TestExecute
        run: |
          	Invoke-WebRequest -Uri ${{ vars.TEST_EXECUTE_DOWNLOAD_URL }} -o ./TestCompleteInstaller.exe  
      - name: Show working folder content
        run: dir
        shell: cmd
      - name: Install TestExecute
        run: ./TestCompleteInstaller.exe -SilentInstall /accessKey:"${{ secrets.TEST_EXECUTE_ACCESS_KEY }}" -Debug
             echo "TestComplete is installed"
             pwd
             cd ./
             ls
             echo "Hence TestComplete Istalled successfully"

        
